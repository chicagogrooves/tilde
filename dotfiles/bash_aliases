alias edit=subl
alias eprof="edit ~/.profile"
alias sprof=". ~/.bash_profile"
alias nrun="npm run"
alias nlint="npm run lint"
alias ntest="npm test"
alias ns="npm start"

alias ll="ls -l"

alias gg="git grep -n"
alias ggi="git grep -i -n"
alias ggmm="git grep '<<<'"                                        # git grep merge markers
alias grii="git rebase -i HEAD^^"
alias griii="git rebase -i HEAD^^^"
alias griiii="git rebase -i HEAD^^^^"
alias gro='git fetch; git reset --hard @{upstream}; git clean -f'
alias grc='git rebase --continue'
alias gpause="git commit --allow-empty -m Pause"
alias gresume="git commit --allow-empty -m Resume"
alias igrep="grep -i"
alias grepi="grep -i"
alias gb="git branch"
alias gcb="git symbolic-ref HEAD --short" # git current branch
alias glo="git fetch; git log origin/`git symbolic-ref HEAD --short`"
alias gbc="git branch --contains"
alias gbr="git fetch origin && git branch --remote"
alias gc="git clean -id"
alias gap="git add -p"
alias gad="git add . && git diff --cached && git status"
alias gcm="git commit -m"
alias gcamend="git commit --amend"
alias gcam="git add . && git commit -a -m"
alias gcommit="git commit --no-edit"                                        # no arg commit - completes a merge
alias gcmn="git commit -n -m"
alias gcamt="git commit -a -m tweak"
alias gcd="git fetch && git checkout -q" && __git_complete gcd _git_checkout
alias gcdm="git checkout master"
alias gcdb="git checkout -b"
alias gcdt="git checkout --track"
alias gl1="git log -1"
alias gl2="git log -2"
alias gl3="git log -3"
alias gmergetheirs="git merge -s recursive -X theirs"
alias gs="git status"
alias gd="git diff" #&& __git_complete gd _git_checkout
alias gdc="git diff --cached"
alias gdy="git diff master@{yesterday}"
alias gpush="git push"
alias gpushnv="git push --no-verify"
alias gpull="git pull"
alias gpullr="git pull --rebase"
alias grhh="git reset --hard HEAD"

git_branch_matching() {
  # pipefail: a lack of match in grep will fail the pipe
  (set -o pipefail; find .git/refs/heads | grep $1 | sed -e 's/\.git\/refs\/heads\///g') ||
  git branch -r | grep $1 | sed -e 's/origin\///g'
}
alias gbm=git_branch_matching
alias gmb=git_branch_matching

alias brake="bundle exec rake"
alias brspec="bundle exec rspec"
#alias upit="git pull && bundle && rake db:migrate db:test:prepare"
alias upit="git pull && npm install && npm test"

alias dcup="docker-compose up --allow-insecure-ssl"
alias dcpull="docker-compose pull --allow-insecure-ssl"

function tickle {
    if [ -n "$1" ] && [ ! -f "$1" ]; then
        path=$(dirname $1)
        file=$(basename $1)

        [ ! -d "$path" ] && mkdir -p $path
        /usr/bin/touch "$1"
    else
        echo "tickle will mkdir -p and touch the file at the end of the path"
        echo
        echo "Usage:"
        echo "  tickle path/to/filename.ext"
    fi
}

function touch {
    if [ "$1" == "-p" ]; then # fuck with the touch command
        if [ -n "$2" ]; then
            tickle "$2"
        else
            echo "Usage:"
            echo "  touch -p /non/existent/path/to/filename.ext"
        fi
    else # pass through to the real touch command
        /usr/bin/touch "$@"
    fi
}

function termtitle {
    echo -ne "\033]0;$1\007"
}
alias tt="termtitle"
